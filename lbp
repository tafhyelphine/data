#imports
import numpy as np
import matplotlib.pyplot as plt
from skimage import data, color
from skimage.feature import local_binary_pattern #scikit-image
from sklearn.cluster import KMeans #scikit-learn
from skimage.io import imread

#parameters
radius = 3  # LBP radius
n_points = 8 * radius  # Number of points to consider in LBP

image = imread("image2.png", as_gray=True)

#features
lbp = local_binary_pattern(image, n_points, radius, method='uniform')

lbp_flat = lbp.reshape(-1, 1)

#segment using the features
n_clusters = 3
kmeans = KMeans(n_clusters=n_clusters, random_state=42)
labels = kmeans.fit_predict(lbp_flat)

segmented_img = labels.reshape(image.shape)

# Plot results
fig, axes = plt.subplots(1, 3, figsize=(15, 5))
axes[0].imshow(image, cmap='gray')
axes[0].set_title('Original Image')
axes[0].axis('off')

axes[1].imshow(lbp, cmap='gray')
axes[1].set_title('LBP Image')
axes[1].axis('off')

axes[2].imshow(segmented_img, cmap='jet')
axes[2].set_title(f'Segmented Image ({n_clusters} regions)')
axes[2].axis('off')

plt.tight_layout()
plt.show()
